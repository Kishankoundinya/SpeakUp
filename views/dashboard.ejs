<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home page</title>
    <link rel="stylesheet" href="/dashboard.css">
    <style></style>
</head>

<body>
    <nav>
        <div class="left">
            <h1 class="logo">Speakup</h1>
        </div>

        <div class="right">
             <details class="popup-menu">
                <summary>
                    <img class="userimg" src="/user.png" alt="User">

                </summary>
                <div class="menu-options">
                    <div class="menu-option">

                        <span><a class="menu-anchor" href="/profile">Profile</a></span>
                    </div>
                    <div class="menu-option">

                        <span><a class="menu-anchor" href="/new">create post</a></span>
                    </div>
                    <div class="menu-option">

                        <span><a class="menu-anchor" href="/logout">Logout</a></span>
                    </div>
                </div>
            </details>
        </div>
    </nav>
    <div class="top">
        <h1>The People's Voice</h1>
    </div>
    <div class="posts">

        <% for(post of posts){ %>
            <div class="post">
                <div class="upper">
                    <div class="top-section">
                        <div class="top-left">
                            <h2 class="user">@<%= post.username%>
                            </h2>

                        </div>
                        <div class="top-right">
                            <h5 class="date">
                                Posted on: <br>
                                <%= new Date(post.date).toLocaleDateString('en-US', { day: '2-digit' , month: 'short' ,
                                    year: 'numeric' }) %>

                                    <%= new Date(post.date).toLocaleTimeString('en-US', { hour: 'numeric' ,
                                        minute: '2-digit' , hour12: true }) %>
                            </h5>
                        </div>
                    </div>
                    <hr>
                    <hr>
                </div>

                <div class="content">
                    <h4>
                        <%= post.content%>
                    </h4>
                </div>
                    <div class="bottom-section">
                        <a class="userbtn" href="/post/<%=post._id%>">View Voice</a>
                    </div>

            </div>

            <%}%>





    </div>

    <script>
        document.addEventListener("click", (event) => {
            document.querySelectorAll(".popup-menu[open]").forEach((menu) => {
                if (!menu.contains(event.target)) {
                    menu.removeAttribute("open");
                }
            });
        });
         document.querySelectorAll(".popup-menu > summary").forEach((summary) => {
            summary.addEventListener("click", (event) => {
                event.stopPropagation();
            });
        });

      
        //////////////////////////////
        document.addEventListener('DOMContentLoaded', function () {
            const menuOptions = document.querySelector('.menu-options');
            if (menuOptions) {
                menuOptions.addEventListener('click', function (e) {
                    if (e.target.closest('.menu-option')) {
                        const option = e.target.closest('.menu-option').textContent.trim();
                        if (option === 'Profile') {
                            // Add your profile action here
                            console.log('Profile clicked');
                        } else if (option === 'Logout') {
                            // Add your logout action here
                            console.log('Logout clicked');
                        }
                    }
                });
            }
        });
        const userimg = document.querySelector(".userimg");
        userimg.addEventListener('dblclick', () => {
            window.location.href = '/profile'
        })
    </script>
</body>

</html>
